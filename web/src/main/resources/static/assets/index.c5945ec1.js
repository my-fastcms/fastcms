var F=Object.defineProperty;var D=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var y=(e,t,a)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,z=(e,t)=>{for(var a in t||(t={}))H.call(t,a)&&y(e,a,t[a]);if(D)for(var a of D(t))N.call(t,a)&&y(e,a,t[a]);return e};import{g as T}from"./index.a0252aff.js";import{_ as A,L as R}from"./index.b56fc134.js";import j from"./detail.cf2ea44d.js";import{r as E,j as w,o as L,t as B,l,m as p,z as s,A as r,b as m,D as i,Y as I,X as U,Q as _,p as g,y as V,L as M,x as P}from"./vendor.07d41a1e.js";const q={name:"attachManager",components:{Detail:j},setup(){const e=E(),t=E(),a=w({fit:"fill",queryParams:{},showSearch:!0,limit:5,uploadUrl:"fastcms/api/admin/attachment/upload",headers:{Authorization:R.get("token")},tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10}}}),o=()=>{T(a.tableData.param).then(n=>{a.tableData.data=n.data.records,a.tableData.total=n.data.total})},f=n=>{n.code==200?(t.value.clearFiles(),o()):m.error(n.message)},h=()=>{m.error("\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 "+a.limit+" \u4E2A!")},d=()=>{m.error("\u4E0A\u4F20\u5931\u8D25")};return L(()=>{o()}),z({detailRef:e,uploadRef:t,initTableData:o,onTableItemClick:n=>{e.value.openDialog(n.id)},onHandleSizeChange:n=>{a.tableData.param.pageSize=n,o()},onHandleCurrentChange:n=>{a.tableData.param.pageNum=n,o()},onHandleExceed:h,onHandleUploadError:d,uploadSuccess:f},B(a))}},Q={class:"list-adapt-container"},X=P("\u4E0A\u4F20\u9644\u4EF6"),Y={key:0},G=["src","fit"],J={style:{padding:"14px"}};function K(e,t,a,o,f,h){const d=l("el-button"),b=l("el-upload"),c=l("el-card"),C=l("el-col"),n=l("el-row"),k=l("el-empty"),v=l("el-pagination"),S=l("Detail");return i(),p("div",Q,[s(b,{ref:"uploadRef",class:"upload-btn",action:e.uploadUrl,name:"files",multiple:"",headers:e.headers,"show-file-list":!1,"on-success":o.uploadSuccess,"on-exceed":o.onHandleExceed,"on-error":o.onHandleUploadError,limit:e.limit},{default:r(()=>[s(d,{size:"small",type:"primary"},{default:r(()=>[X]),_:1})]),_:1},8,["action","headers","on-success","on-exceed","on-error","limit"]),s(c,{shadow:"hover"},{default:r(()=>[e.tableData.data.length>0?(i(),p("div",Y,[s(n,{gutter:15},{default:r(()=>[(i(!0),p(I,null,U(e.tableData.data,(u,x)=>(i(),_(C,{xs:24,sm:12,md:8,lg:6,xl:4,class:"mb15",key:x,onClick:O=>o.onTableItemClick(u)},{default:r(()=>[s(c,{"body-style":{padding:"0px"}},{default:r(()=>[g("img",{src:u.typePath,fit:e.fit,class:"image"},null,8,G),g("div",J,[g("span",null,V(u.fileName),1)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])):(i(),_(k,{key:1,description:"\u6682\u65E0\u6570\u636E"})),e.tableData.data.length>0?(i(),_(v,{key:2,style:{"text-align":"right"},background:"",onSizeChange:o.onHandleSizeChange,onCurrentChange:o.onHandleCurrentChange,"page-sizes":[10,20,30],"current-page":e.tableData.param.pageNum,"page-size":e.tableData.param.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])):M("",!0)]),_:1}),s(S,{ref:"detailRef",onReloadTable:o.initTableData},null,8,["onReloadTable"])])}var te=A(q,[["render",K],["__scopeId","data-v-27b62b47"]]);export{te as default};
