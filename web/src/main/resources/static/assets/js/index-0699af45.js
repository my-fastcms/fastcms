import{u as R,b as A}from"./vue-router-c1461dfc.js";import{u as K}from"./vue-i18n-b3581196.js";import{p as j,S as B}from"./index-b1371ca3.js";import{a as L}from"./formatTime-29ac8c52.js";import{L as z}from"./index-fdeaa6cf.js";import{q as v}from"./qs-c5b6dbf2.js";import{C as E}from"./index-e533b5d9.js";import{a as _}from"./element-plus-91d6d961.js";import{H as V,e as D,_ as J,j as C,i as M,ah as m,o as O,c as H,a as r,U as c,V as s,P as a,J as P,T as G}from"./@vue-6dabbe94.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./@intlify-ea47d1db.js";import"./source-map-7d7e1c08.js";import"./vue-b1ba6f14.js";import"./pinia-b6f74250.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-64e6e14a.js";import"./nprogress-08a53ce8.js";import"./axios-4a70c6fc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-ec2a62c3.js";import"./side-channel-394f276c.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-8fd4bade.js";import"./lodash-es-9851428c.js";import"./@vueuse-e129c873.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-f6fdf7b4.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-b8998962.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-880a26aa.js";const W={class:"login-container"},X={class:"login-logo"},Y={class:"login-content"},Z={class:"login-content-main"},ee={class:"login-content-title"},oe={class:"login-content-code"},te=["src"],se={class:"mt10"},re={class:"login-copyright"},ae={class:"mb5 login-copyright-company"},ne={class:"login-copyright-msg"},ie=V({name:"register"}),le=V({...ie,setup(me){const y=z(),k=E(),h=D(),{t:F}=K();getCurrentInstance();const w=j,u=R(),d=A(),e=J({isShowPassword:!1,public_website_title:w.state.value.themeConfig.globalTitle,captcha:"",captchaKey:"",myForm:{nickName:"",username:"",password:"",repeatPassword:"",code:""},rules:{username:{required:!0,message:"请输入账号",trigger:"blur"},nickName:{required:!0,message:"请输入用户昵称",trigger:"blur"},password:{required:!0,message:"请输入密码",trigger:"blur"},repeatPassword:{required:!0,message:"请输入确认密码",trigger:"blur"},code:{required:!0,message:"请输入验证码",trigger:"blur"}},loading:{registerIn:!1}}),x=C(()=>w.state.value.themeConfig),S=C(()=>L(new Date)),g=async()=>{y.getCaptcha().then(o=>{e.captcha=o.data.image,e.captchaKey=o.data.codeUuid,B.set("ClientId",e.captchaKey)}).catch(()=>{})};M(()=>{g();let o=new Array;o.push("public_website_title");let t=v.stringify({configKeys:o},{arrayFormat:"repeat"});k.getPublicConfigList(t).then(l=>{l.data.forEach(n=>{n.key=="public_website_title"&&n.jsonValue!=null&&(e.public_website_title=n.jsonValue)})})});const $=async()=>{new Promise(o=>{h.value.validate(t=>{t&&(o(t),q())})})},q=async()=>{y.register(v.stringify(e.myForm)).then(()=>{I()}).catch(o=>{g(),_({showClose:!0,message:o.message?o.message:"系统错误",type:"error"})})},I=()=>{var t,l,n,p;let o=S.value;(t=u.query)!=null&&t.redirect?d.push({path:(l=u.query)==null?void 0:l.redirect,query:Object.keys((n=u.query)==null?void 0:n.params).length>0?JSON.parse((p=u.query)==null?void 0:p.params):""}):d.push("/login"),setTimeout(()=>{e.loading.registerIn=!0;const f=F("message.registerInText");_.success(`${o}，${f}`)},300)},T=()=>{d.push("/login")},N=()=>{/[^a-z0-9_]/g.test(e.myForm.username)&&(e.myForm.username="",_({showClose:!0,message:"只能输入英文字母数字",type:"error"}))};return(o,t)=>{const l=m("el-input"),n=m("el-form-item"),p=m("el-col"),f=m("el-row"),b=m("el-button"),U=m("el-form");return O(),H("div",W,[r("div",X,[r("span",null,c(x.value.globalViceTitle),1)]),r("div",Y,[r("div",Z,[r("h4",ee,c(e.public_website_title),1),r("div",null,[s(U,{class:"login-content-form",model:e.myForm,rules:e.rules,ref_key:"myRefForm",ref:h},{default:a(()=>[s(n,{prop:"username"},{default:a(()=>[s(l,{type:"text",placeholder:o.$t("message.account.accountPlaceholder1"),"prefix-icon":"el-icon-user",modelValue:e.myForm.username,"onUpdate:modelValue":t[0]||(t[0]=i=>e.myForm.username=i),clearable:"",autocomplete:"off",onChange:N},null,8,["placeholder","modelValue"])]),_:1}),s(n,{prop:"nickName"},{default:a(()=>[s(l,{type:"text",placeholder:o.$t("message.account.accountPlaceholder6"),"prefix-icon":"el-icon-user",modelValue:e.myForm.nickName,"onUpdate:modelValue":t[1]||(t[1]=i=>e.myForm.nickName=i),clearable:"",autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1}),s(n,{prop:"password"},{default:a(()=>[s(l,{type:e.isShowPassword?"text":"password",placeholder:o.$t("message.account.accountPlaceholder2"),"prefix-icon":"el-icon-lock",modelValue:e.myForm.password,"onUpdate:modelValue":t[3]||(t[3]=i=>e.myForm.password=i),autocomplete:"off"},{suffix:a(()=>[r("i",{class:P(["iconfont el-input__icon login-content-password",e.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:t[2]||(t[2]=i=>e.isShowPassword=!e.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(n,{prop:"repeatPassword"},{default:a(()=>[s(l,{type:e.isShowPassword?"text":"password",placeholder:o.$t("message.account.accountPlaceholder4"),"prefix-icon":"el-icon-lock",modelValue:e.myForm.repeatPassword,"onUpdate:modelValue":t[5]||(t[5]=i=>e.myForm.repeatPassword=i),autocomplete:"off"},{suffix:a(()=>[r("i",{class:P(["iconfont el-input__icon login-content-password",e.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:t[4]||(t[4]=i=>e.isShowPassword=!e.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(n,{prop:"code"},{default:a(()=>[s(f,{gutter:15},{default:a(()=>[s(p,{span:14},{default:a(()=>[s(l,{type:"text",maxlength:"5",placeholder:o.$t("message.account.accountPlaceholder3"),"prefix-icon":"el-icon-position",modelValue:e.myForm.code,"onUpdate:modelValue":t[6]||(t[6]=i=>e.myForm.code=i),clearable:"",autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1}),s(p,{span:10},{default:a(()=>[r("div",oe,[r("img",{class:"login-content-code-img",alt:"fastcms",onClick:g,src:o.captcha},null,8,te)])]),_:1})]),_:1})]),_:1}),s(n,null,{default:a(()=>[s(b,{type:"primary",class:"login-content-submit",round:"",onClick:$,loading:o.loading.registerIn},{default:a(()=>[r("span",null,c(o.$t("message.account.accountRegistBtnText")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),r("div",se,[s(b,{type:"text",size:"small",onClick:T},{default:a(()=>[G(c(o.$t("message.link.two5")),1)]),_:1})])])])]),r("div",re,[r("div",ae,c(o.$t("message.copyright.one5")),1),r("div",ne,c(o.$t("message.copyright.two6")),1)])])}}});const Ge=Q(le,[["__scopeId","data-v-e658fa5f"]]);export{Ge as default};
