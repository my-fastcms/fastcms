import{U as B}from"./index-c39dd0f2.js";import{R as E}from"./index-b671ca80.js";import{D as M}from"./index-2e87211a.js";import{q as z}from"./qs-c5b6dbf2.js";import{a as H}from"./element-plus-91d6d961.js";import{H as w,e as I,_ as O,i as P,ah as m,o as i,c as b,V as l,P as a,a as j,T as F,O as _,S as G,F as x,a8 as L,n as J}from"./@vue-6dabbe94.js";const K={class:"system-user-container"},Q={class:"dialog-footer"},W=w({name:"systemUserDialog"}),oe=w({...W,emits:["reloadTable"],setup(X,{expose:y,emit:U}){const c=I(),f=B(),k=E(),v=M(),e=O({isShowDialog:!1,isAdd:!0,deptList:[],tags:[],roleList:[],ruleForm:{id:null,userName:"",userType:1,password:"",nickName:"",mobile:"",email:"",company:"",address:"",sex:1,status:1,tagList:"",roleList:"",deptList:"",source:"admin_create"},rules:{userName:{required:!0,message:"请输入账号",trigger:"blur"},password:{required:!0,message:"请输入密码",trigger:"blur"},nickName:{required:!0,message:"请输入昵称",trigger:"blur"}}}),N=s=>{e.isShowDialog=!0,s?(e.isAdd=!1,f.getUserInfo(s.id).then(o=>{delete o.data.loginTime,delete o.data.created,delete o.data.updated,e.ruleForm=o.data})):J(()=>{e.isAdd=!0,e.ruleForm.id=null,e.ruleForm.tagList="",e.ruleForm.roleList="",e.ruleForm.deptList="",c.value.resetFields()})},g=()=>{e.isShowDialog=!1},A=()=>{g()},D=()=>{c.value.validate(s=>{if(s){let o=z.stringify(e.ruleForm,{arrayFormat:"repeat"});f.saveUser(o).then(()=>{g(),U("reloadTable")}).catch(u=>{H({showClose:!0,message:u.message?u.message:"系统错误",type:"error"})})}})},h=()=>{k.getRoleSelectList().then(s=>{e.roleList=s.data}).catch(s=>{console.log(s)}),f.getTagList().then(s=>{e.tags=s.data}),v.getDeptList().then(s=>{e.deptList=s.data})};return P(()=>{h()}),y({openDialog:N}),(s,o)=>{const u=m("el-input"),r=m("el-form-item"),d=m("el-col"),n=m("el-option"),p=m("el-select"),S=m("el-cascader"),C=m("el-row"),T=m("el-form"),V=m("el-button"),R=m("el-dialog");return i(),b("div",K,[l(R,{title:"新增员工",modelValue:e.isShowDialog,"onUpdate:modelValue":o[12]||(o[12]=t=>e.isShowDialog=t),width:"769px"},{footer:a(()=>[j("span",Q,[l(V,{onClick:A},{default:a(()=>[F("取 消")]),_:1}),l(V,{type:"primary",onClick:D},{default:a(()=>[F("保 存")]),_:1})])]),default:a(()=>[l(T,{model:e.ruleForm,size:"default","label-width":"80px",rules:e.rules,ref_key:"myRefForm",ref:c},{default:a(()=>[l(C,{gutter:35},{default:a(()=>[l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"账号",prop:"userName"},{default:a(()=>[l(u,{modelValue:e.ruleForm.userName,"onUpdate:modelValue":o[0]||(o[0]=t=>e.ruleForm.userName=t),readonly:!e.isAdd,placeholder:"请输入账号",clearable:""},null,8,["modelValue","readonly"])]),_:1})]),_:1}),e.isAdd?(i(),_(d,{key:0,xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"密码",prop:"password"},{default:a(()=>[l(u,{modelValue:e.ruleForm.password,"onUpdate:modelValue":o[1]||(o[1]=t=>e.ruleForm.password=t),type:"password",placeholder:"请输入密码",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):G("",!0),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"昵称",prop:"nickName"},{default:a(()=>[l(u,{modelValue:e.ruleForm.nickName,"onUpdate:modelValue":o[2]||(o[2]=t=>e.ruleForm.nickName=t),placeholder:"请输入昵称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"手机号码",prop:"mobile"},{default:a(()=>[l(u,{modelValue:e.ruleForm.mobile,"onUpdate:modelValue":o[3]||(o[3]=t=>e.ruleForm.mobile=t),placeholder:"请输入手机号码",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"电子邮箱",prop:"email"},{default:a(()=>[l(u,{modelValue:e.ruleForm.email,"onUpdate:modelValue":o[4]||(o[4]=t=>e.ruleForm.email=t),placeholder:"请输入电子邮箱",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"公司",prop:"company"},{default:a(()=>[l(u,{modelValue:e.ruleForm.company,"onUpdate:modelValue":o[5]||(o[5]=t=>e.ruleForm.company=t),placeholder:"请输入公司名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"地址",prop:"address"},{default:a(()=>[l(u,{modelValue:e.ruleForm.address,"onUpdate:modelValue":o[6]||(o[6]=t=>e.ruleForm.address=t),placeholder:"请输入地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"性别"},{default:a(()=>[l(p,{modelValue:e.ruleForm.sex,"onUpdate:modelValue":o[7]||(o[7]=t=>e.ruleForm.sex=t),placeholder:"请选择性别",clearable:"",class:"w100"},{default:a(()=>[l(n,{label:"男",value:1}),l(n,{label:"女",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:a(()=>[l(r,{label:"状态"},{default:a(()=>[l(p,{modelValue:e.ruleForm.status,"onUpdate:modelValue":o[8]||(o[8]=t=>e.ruleForm.status=t),placeholder:"请选择状态",clearable:"",class:"w100"},{default:a(()=>[l(n,{label:"启用",value:1}),l(n,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(d,{class:"mb20"},{default:a(()=>[l(r,{label:"用户标签"},{default:a(()=>[l(p,{modelValue:e.ruleForm.tagList,"onUpdate:modelValue":o[9]||(o[9]=t=>e.ruleForm.tagList=t),class:"w100",multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"可直接输入标签名称"},{default:a(()=>[(i(!0),b(x,null,L(e.tags,t=>(i(),_(n,{key:t.id,label:t.title,value:t.title},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(d,{class:"mb20"},{default:a(()=>[l(r,{label:"分配部门"},{default:a(()=>[l(S,{modelValue:e.ruleForm.deptList,"onUpdate:modelValue":o[10]||(o[10]=t=>e.ruleForm.deptList=t),options:e.deptList,placeholder:"请选择部门",props:{checkStrictly:!0,multiple:!0,label:"label",value:"id",children:"children"},class:"w100",clearable:""},null,8,["modelValue","options"])]),_:1})]),_:1}),l(d,{class:"mb20"},{default:a(()=>[l(r,{label:"分配角色"},{default:a(()=>[l(p,{modelValue:e.ruleForm.roleList,"onUpdate:modelValue":o[11]||(o[11]=t=>e.ruleForm.roleList=t),multiple:"",placeholder:"请选择角色",clearable:"",class:"w100"},{default:a(()=>[(i(!0),b(x,null,L(e.roleList,(t,q)=>(i(),_(n,{key:q,label:t.roleName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{oe as _};
