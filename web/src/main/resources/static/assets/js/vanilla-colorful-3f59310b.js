const c=(e,t=0,o=1)=>e>o?o:e<t?t:e,n=(e,t=0,o=Math.pow(10,t))=>Math.round(o*e)/o,T=e=>z(b(e)),b=e=>(e[0]==="#"&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?n(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:e.length===8?n(parseInt(e.substring(6,8),16)/255,2):1}),L=e=>A(q(e)),I=({h:e,s:t,v:o,a:r})=>{const s=(200-t)*o/100;return{h:n(e),s:n(s>0&&s<200?t*o/100/(s<=100?s:200-s)*100:0),l:n(s/2),a:n(r,2)}},m=e=>{const{h:t,s:o,l:r}=I(e);return`hsl(${t}, ${o}%, ${r}%)`},q=({h:e,s:t,v:o,a:r})=>{e=e/360*6,t=t/100,o=o/100;const s=Math.floor(e),a=o*(1-t),i=o*(1-(e-s)*t),h=o*(1-(1-e+s)*t),p=s%6;return{r:n([o,i,a,a,h,o][p]*255),g:n([h,o,o,i,a,a][p]*255),b:n([a,a,h,o,o,i][p]*255),a:n(r,2)}},u=e=>{const t=e.toString(16);return t.length<2?"0"+t:t},A=({r:e,g:t,b:o,a:r})=>{const s=r<1?u(n(r*255)):"";return"#"+u(e)+u(t)+u(o)+s},z=({r:e,g:t,b:o,a:r})=>{const s=Math.max(e,t,o),a=s-Math.min(e,t,o),i=a?s===e?(t-o)/a:s===t?2+(o-e)/a:4+(e-t)/a:0;return{h:n(60*(i<0?i+6:i)),s:n(s?a/s*100:0),v:n(s/255*100),a:r}},C=(e,t)=>{if(e===t)return!0;for(const o in e)if(e[o]!==t[o])return!1;return!0},O=(e,t)=>e.toLowerCase()===t.toLowerCase()?!0:C(b(e),b(t)),y={},E=e=>{let t=y[e];return t||(t=document.createElement("template"),t.innerHTML=e,y[e]=t),t},x=(e,t,o)=>{e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:o}))};let l=!1;const v=e=>"touches"in e,P=e=>l&&!v(e)?!1:(l||(l=v(e)),!0),w=(e,t)=>{const o=v(t)?t.touches[0]:t,r=e.el.getBoundingClientRect();x(e.el,"move",e.getMove({x:c((o.pageX-(r.left+window.pageXOffset))/r.width),y:c((o.pageY-(r.top+window.pageYOffset))/r.height)}))},B=(e,t)=>{const o=t.keyCode;o>40||e.xy&&o<37||o<33||(t.preventDefault(),x(e.el,"move",e.getMove({x:o===39?.01:o===37?-.01:o===34?.05:o===33?-.05:o===35?1:o===36?-1:0,y:o===40?.01:o===38?-.01:0},!0)))};class S{constructor(t,o,r,s){const a=E(`<div role="slider" tabindex="0" part="${o}" ${r}><div part="${o}-pointer"></div></div>`);t.appendChild(a.content.cloneNode(!0));const i=t.querySelector(`[part=${o}]`);i.addEventListener("mousedown",this),i.addEventListener("touchstart",this),i.addEventListener("keydown",this),this.el=i,this.xy=s,this.nodes=[i.firstChild,i]}set dragging(t){const o=t?document.addEventListener:document.removeEventListener;o(l?"touchmove":"mousemove",this),o(l?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!P(t)||!l&&t.button!=0)return;this.el.focus(),w(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),w(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":B(this,t);break}}style(t){t.forEach((o,r)=>{for(const s in o)this.nodes[r].style.setProperty(s,o[s])})}}class D extends S{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:`${t/360*100}%`,color:m({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${n(t)}`)}getMove(t,o){return{h:o?c(this.h+t.x*360,0,360):360*t.x}}}class R extends S{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:`${100-t.v}%`,left:`${t.s}%`,color:m(t)},{"background-color":m({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${n(t.s)}%, Brightness ${n(t.v)}%`)}getMove(t,o){return{s:o?c(this.hsva.s+t.x*100,0,100):t.x*100,v:o?c(this.hsva.v-t.y*100,0,100):Math.round(100-t.y*100)}}}const j=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',N="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",V="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",d=Symbol("same"),f=Symbol("color"),$=Symbol("hsva"),g=Symbol("update"),H=Symbol("parts"),M=Symbol("css"),k=Symbol("sliders");class X extends HTMLElement{static get observedAttributes(){return["color"]}get[M](){return[j,N,V]}get[k](){return[R,D]}get color(){return this[f]}set color(t){if(!this[d](t)){const o=this.colorModel.toHsva(t);this[g](o),this[f]=t}}constructor(){super();const t=E(`<style>${this[M].join("")}</style>`),o=this.attachShadow({mode:"open"});o.appendChild(t.content.cloneNode(!0)),o.addEventListener("move",this),this[H]=this[k].map(r=>new r(o))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,o,r){const s=this.colorModel.fromAttr(r);this[d](s)||(this.color=s)}handleEvent(t){const o=this[$],r={...o,...t.detail};this[g](r);let s;!C(r,o)&&!this[d](s=this.colorModel.fromHsva(r))&&(this[f]=s,x(this,"color-changed",{value:s}))}[d](t){return this.color&&this.colorModel.equal(t,this.color)}[g](t){this[$]=t,this[H].forEach(o=>o.update(t))}}const Y={defaultColor:"#000",toHsva:T,fromHsva:({h:e,s:t,v:o})=>L({h:e,s:t,v:o,a:1}),equal:O,fromAttr:e=>e};class _ extends X{get colorModel(){return Y}}class F extends _{}customElements.define("hex-color-picker",F);
