import{q as w}from"./qs-c5b6dbf2.js";import{C as x}from"./index-54ae9b6f.js";import{a as V}from"./element-plus-91d6d961.js";import{H as y,e as C,_ as q,i as T,ah as m,o as J,c as U,V as e,P as l,T as F,bh as W,bf as S,a as c}from"./@vue-6dabbe94.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./@intlify-ea47d1db.js";import"./source-map-7d7e1c08.js";import"./side-channel-394f276c.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-8fd4bade.js";import"./index-b9e84531.js";import"./pinia-b6f74250.js";import"./vue-router-c1461dfc.js";import"./vue-i18n-b3581196.js";import"./vue-b1ba6f14.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-64e6e14a.js";import"./nprogress-08a53ce8.js";import"./axios-4a70c6fc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-ec2a62c3.js";import"./lodash-es-9851428c.js";import"./@vueuse-e129c873.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-f6fdf7b4.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-b8998962.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-880a26aa.js";const f=p=>(W("data-v-965f5f62"),p=p(),S(),p),E={class:"personal"},M=f(()=>c("div",{class:"personal-edit-title mb15"},"JWT设置",-1)),B=f(()=>c("div",{class:"personal-edit-title mb15"},"登录",-1)),I=f(()=>c("div",{class:"personal-edit-title mb15"},"注册",-1)),N=y({name:"websiteSet"}),K=y({...N,setup(p){const b=x(),g=C(),o=q({fit:"fill",loading:!1,ruleForm:{jwt_secret:"",jwt_expire:"18000",pwd_min_length:6,public_register_enable:!1,public_mp_scan_qrcode_login_enable:!1,public_mp_scan_qrcode_login_is_default:!1,public_forgot_password_enable:!0,allow_pwd_error_count:10},rules:{jwt_secret:[{required:!0,message:"请输入JWT密钥",trigger:"blur"}],jwt_expire:[{required:!0,message:"请输入JWT时效",trigger:"blur"}]}}),v=()=>{g.value.validate(u=>{if(u){let t=w.stringify(o.ruleForm,{arrayFormat:"repeat"});b.saveConfig(t).then(()=>{V.success("保存成功")}).catch(_=>{V({showClose:!0,message:_.message?_.message:"系统错误",type:"error"})})}})},h=()=>{const t=[],_="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",r=_.length;for(let n=0;n<69;n++)t.push(_.charAt(Math.floor(Math.random()*r)));let a=t.join("");o.ruleForm.jwt_secret=a};return T(()=>{let u=new Array;Object.keys(o.ruleForm).forEach(r=>{u.push(r)});let _=w.stringify({configKeys:u},{arrayFormat:"repeat"});b.getConfigList(_).then(r=>{r.data.forEach(a=>{o.ruleForm[a.key]=a.jsonValue})})}),(u,t)=>{const _=m("el-input"),r=m("el-form-item"),a=m("el-col"),n=m("el-button"),i=m("el-row"),d=m("el-switch"),j=m("el-form"),k=m("el-card");return J(),U("div",E,[e(i,null,{default:l(()=>[e(a,{span:24},{default:l(()=>[e(k,{shadow:"hover"},{default:l(()=>[e(j,{model:o.ruleForm,rules:o.rules,ref_key:"myRefForm",ref:g,"label-width":"150px",class:"mt35 mb35"},{default:l(()=>[M,e(i,{gutter:35},{default:l(()=>[e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"JWT密钥",prop:"jwt_secret"},{default:l(()=>[e(_,{modelValue:o.ruleForm.jwt_secret,"onUpdate:modelValue":t[0]||(t[0]=s=>o.ruleForm.jwt_secret=s),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(a,{class:"mb20"},{default:l(()=>[e(r,null,{default:l(()=>[e(n,{loading:o.loading,onClick:h},{default:l(()=>[F("生成JWT密钥")]),_:1},8,["loading"])]),_:1})]),_:1}),e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"JWT时效",prop:"jwt_expire"},{default:l(()=>[e(_,{modelValue:o.ruleForm.jwt_expire,"onUpdate:modelValue":t[1]||(t[1]=s=>o.ruleForm.jwt_expire=s),placeholder:"请输入JWT时效，整数，单位秒",onkeyup:"value=value.replace(/[^\\d]/g,'')",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),B,e(i,{gutter:35},{default:l(()=>[e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"是否开启公众号扫码登录"},{default:l(()=>[e(d,{modelValue:o.ruleForm.public_mp_scan_qrcode_login_enable,"onUpdate:modelValue":t[2]||(t[2]=s=>o.ruleForm.public_mp_scan_qrcode_login_enable=s),"active-color":"#13ce66"},null,8,["modelValue"])]),_:1})]),_:1}),e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"是否默认使用公众号扫码登录"},{default:l(()=>[e(d,{modelValue:o.ruleForm.public_mp_scan_qrcode_login_is_default,"onUpdate:modelValue":t[3]||(t[3]=s=>o.ruleForm.public_mp_scan_qrcode_login_is_default=s),"active-color":"#13ce66"},null,8,["modelValue"])]),_:1})]),_:1}),e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"允许错误密码输入最大次数",prop:"allow_pwd_error_count"},{default:l(()=>[e(_,{modelValue:o.ruleForm.allow_pwd_error_count,"onUpdate:modelValue":t[4]||(t[4]=s=>o.ruleForm.allow_pwd_error_count=s),placeholder:"",onkeyup:"value=value.replace(/[^\\d]/g,'')",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"是否启用找回密码功能"},{default:l(()=>[e(d,{modelValue:o.ruleForm.public_forgot_password_enable,"onUpdate:modelValue":t[5]||(t[5]=s=>o.ruleForm.public_forgot_password_enable=s),"active-color":"#13ce66"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),I,e(i,{gutter:35},{default:l(()=>[e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"是否开启注册功能"},{default:l(()=>[e(d,{modelValue:o.ruleForm.public_register_enable,"onUpdate:modelValue":t[6]||(t[6]=s=>o.ruleForm.public_register_enable=s),"active-color":"#13ce66"},null,8,["modelValue"])]),_:1})]),_:1}),e(a,{class:"mb20"},{default:l(()=>[e(r,{label:"密码最短长度",prop:"pwd_min_length"},{default:l(()=>[e(_,{modelValue:o.ruleForm.pwd_min_length,"onUpdate:modelValue":t[7]||(t[7]=s=>o.ruleForm.pwd_min_length=s),placeholder:"请输入密码最少长度，整数，默认6",onkeyup:"value=value.replace(/[^\\d]/g,'')",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(r,null,{default:l(()=>[e(n,{type:"primary",onClick:v,size:"default"},{default:l(()=>[F("保 存")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})])}}});const he=A(K,[["__scopeId","data-v-965f5f62"]]);export{he as default};
