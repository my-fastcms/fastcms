var A=Object.defineProperty;var S=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var E=(e,t,l)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,z=(e,t)=>{for(var l in t||(t={}))T.call(t,l)&&E(e,l,t[l]);if(S)for(var l of S(t))j.call(t,l)&&E(e,l,t[l]);return e};import{g as F}from"./index.833f460b.js";import{g as V}from"./client.46cb79db.js";import{_ as N,L as U}from"./index.5d8bc6a4.js";import{j as B,o as L,t as I,l as s,D as c,Q as p,A as n,p as u,z as r,m as x,Y as O,X as M,y as q,L as P,b as H,x as b}from"./vendor.07d41a1e.js";const Q={emits:["attachHandler"],name:"attachDialog",props:{fileType:String,isClient:{type:Boolean,default:!1}},setup(e,t){let l="fastcms/api/admin/attachment/upload";e.isClient&&e.isClient==!0&&(l="fastcms/api/client/attachment/upload");const a=B({isShowDialog:!1,queryParams:{},showSearch:!0,max:1,limit:3,uploadUrl:l,headers:{Authorization:U.get("token")},checkedObjs:[],tableData:{data:[],total:99,loading:!1,param:{pageNum:1,pageSize:10}}}),f=o=>{a.isShowDialog=!0,a.max=o},g=()=>{a.isShowDialog=!1,a.max=1},i=()=>{e.fileType&&(console.log("==>fileType:"+e.fileType),a.tableData.param.fileType=e.fileType),e.isClient&&e.isClient==!0?V(a.tableData.param).then(o=>{a.tableData.data=o.data.records,a.tableData.total=o.data.total}):F(a.tableData.param).then(o=>{a.tableData.data=o.data.records,a.tableData.total=o.data.total})},_=()=>{i()},h=()=>{H.error("\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 "+a.limit+" \u4E2A!")},m=()=>{H.error("\u4E0A\u4F20\u5931\u8D25")};return L(()=>{i()}),z({openDialog:f,closeDialog:g,initTableData:i,onTableItemClick:o=>{console.log(o)},onHandleSizeChange:o=>{a.tableData.param.pageSize=o,i()},onHandleCurrentChange:o=>{a.tableData.param.pageNum=o,i()},onHandleExceed:h,onHandleUploadError:m,uploadSuccess:_,onSubmit:()=>{t.emit("attachHandler",a.checkedObjs),g()}},I(a))}},R=b("\u4E0A\u4F20\u9644\u4EF6"),X={key:0},Y=["src"],G={style:{padding:"14px"}},J={class:"dialog-footer"},K=b("\u53D6 \u6D88"),W=b("\u786E \u5B9A");function Z(e,t,l,a,f,g){const i=s("el-button"),_=s("el-upload"),h=s("el-checkbox"),m=s("el-card"),D=s("el-col"),C=s("el-checkbox-group"),y=s("el-row"),k=s("el-empty"),o=s("el-pagination"),v=s("el-dialog");return c(),p(v,{title:"\u9009\u62E9\u9644\u4EF6",fullscreen:"",modelValue:e.isShowDialog,"onUpdate:modelValue":t[1]||(t[1]=d=>e.isShowDialog=d)},{footer:n(()=>[u("span",J,[r(i,{onClick:a.closeDialog,size:"small"},{default:n(()=>[K]),_:1},8,["onClick"]),r(i,{type:"primary",onClick:a.onSubmit,size:"small"},{default:n(()=>[W]),_:1},8,["onClick"])])]),default:n(()=>[u("div",null,[r(_,{class:"upload-btn",action:e.uploadUrl,name:"files",multiple:"",headers:e.headers,"show-file-list":!1,"on-success":a.uploadSuccess,"on-exceed":a.onHandleExceed,"on-error":a.onHandleUploadError,limit:e.limit},{default:n(()=>[r(i,{size:"small",type:"primary"},{default:n(()=>[R]),_:1})]),_:1},8,["action","headers","on-success","on-exceed","on-error","limit"]),r(m,{shadow:"hover"},{default:n(()=>[e.tableData.data.length>0?(c(),x("div",X,[r(y,{gutter:15},{default:n(()=>[r(C,{max:e.max,modelValue:e.checkedObjs,"onUpdate:modelValue":t[0]||(t[0]=d=>e.checkedObjs=d)},{default:n(()=>[(c(!0),x(O,null,M(e.tableData.data,(d,w)=>(c(),p(D,{xs:24,sm:12,md:8,lg:6,xl:4,class:"mb15",key:w,onClick:$=>a.onTableItemClick(d)},{default:n(()=>[r(m,{"body-style":{padding:"0px"}},{default:n(()=>[u("img",{src:d.path,class:"image"},null,8,Y),u("div",G,[r(h,{label:d},{default:n(()=>[u("span",null,q(d.fileName),1)]),_:2},1032,["label"])])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1},8,["max","modelValue"])]),_:1})])):(c(),p(k,{key:1,description:"\u6682\u65E0\u6570\u636E"})),e.tableData.data.length>0?(c(),p(o,{key:2,style:{"text-align":"right"},background:"",onSizeChange:a.onHandleSizeChange,onCurrentChange:a.onHandleCurrentChange,"page-sizes":[10,20,30],"current-page":e.tableData.param.pageNum,"page-size":e.tableData.param.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])):P("",!0)]),_:1})])]),_:1},8,["modelValue"])}var ne=N(Q,[["render",Z],["__scopeId","data-v-6cd1a68e"]]);export{ne as A};
